import{O as y,o as h,R as a,v as n,T as u,U as f,i as x,t as c,z as g,X as m,q as C}from"./nI3R1_-z.js";const $={key:0,class:"w-full flex flex-row justify-start items-center align-center text-xs"},j={key:1,class:"w-full flex flex-row justify-start items-center align-center text-xs"},T={__name:"RatingSystem",props:{track:{type:Object,required:!0}},setup(v){const d=C(),e=v,t=y({stars:{one_star:e.track.ratings.one_star,two_stars:e.track.ratings.two_stars,three_stars:e.track.ratings.three_stars,four_stars:e.track.ratings.four_stars,five_stars:e.track.ratings.five_stars},selected_rating:0,rated:!1,rating:0,average:e.track.ratings.average_rating,sum_of_ratings:0,num_votes:e.track.ratings.num_votes}),k=()=>(t.num_votes=t.stars.one_star+t.stars.two_stars+t.stars.three_stars+t.stars.four_stars+t.stars.five_stars,t.num_votes),p=()=>(t.sum_of_ratings=t.stars.one_star+t.stars.two_stars*2+t.stars.three_stars*3+t.stars.four_stars*4+t.stars.five_stars*5,t.sum_of_ratings),_=()=>(t.average=p()/k(),t.average);h(()=>{_()});const l=r=>{t.selected_rating=r,t.rated=!0,t.rating=r,$fetch(`${d.public.NUXT_STRAPI_URL}/api/tracks/${e.track.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({data:{ratings:{one_star:r===1?t.stars.one_star+1:t.stars.one_star,two_stars:r===2?t.stars.two_stars+1:t.stars.two_stars,three_stars:r===3?t.stars.three_stars+1:t.stars.three_stars,four_stars:r===4?t.stars.four_stars+1:t.stars.four_stars,five_stars:r===5?t.stars.five_stars+1:t.stars.five_stars,total:e.track.ratings.total+1,average_rating:_(),num_votes:e.track.ratings.num_votes+1}}})}).then(o=>{console.log("rating result: ",o)}).catch(o=>{console.log(o)})};return(r,o)=>{const i=x("font-awesome-icon");return a(t).rated?(c(),n("div",j,[(c(),n(u,null,f(5,s=>g(i,{class:m(["me-2 cursor-pointer hover:text-yellow-400",s<=a(t).rating?"text-yellow-400":"text-gray-400"]),icon:[`${s<=a(t).selected_rating?"fas":"far"}`,"star"],color:"#8d8484",key:s,onClick:w=>l(s)},null,8,["class","icon","onClick"])),64))])):(c(),n("div",$,[(c(),n(u,null,f(5,s=>g(i,{class:m(["me-2 cursor-pointer hover:text-yellow-400",[{"text-yellow-400":s<=a(t).selected_rating,"text-gray-400":s>a(t).selected_rating,"text-yellow-400":s<=a(t).average}]]),icon:[`${s<=a(t).selected_rating?"fas":"far"}`,"star"],color:"#8d8484",key:s,onClick:w=>l(s)},null,8,["class","icon","onClick"])),64))]))}}};export{T as default};
